<!--
<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mercadinho da Esquina</title>
    <link rel="stylesheet" href="./fonts.css">
    <style>
        :root {
            /* Cores */
            --cor-primaria: #339e67;
            --cor-secundaria: #de9c31;
            --cor-texto: #161f1a;
            --cor-sucesso: #e9f5ff;
            --cor-branco: #ffffff;
            --cor-erro: #ffcccc;

            /* Espaçamentos */
            --espaco-xs: 0.5rem;
            --espaco-sm: 1rem;
            --espaco-md: 2rem;

            /* Bordas e sombras */
            --borda-radius: 8px;
            --sombra: 0 2px 10px rgba(0, 0, 0, 0.1);

            /* Fontes */
            --fonte-base: 16px;
            --fonte-titulo: 1.5rem;
            --fonte-principal: 'Poppins', sans-serif;

            /* Layout */
            --altura-total: 100dvh;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--fonte-principal), sans-serif;
            background-color: var(--cor-secundaria);
            color: var(--cor-texto);
            line-height: 1.6;
            font-size: var(--fonte-base);
            margin: 0;
            padding: 0;
        }

        h1 {
            font-size: 3rem;
        }

        header p {
            font-size: 1.5rem;
        }

        header,
        footer {
            background-color: rgba(51, 158, 103, 0.9); /* Semitransparente */
            color: var(--cor-secundaria);
            text-align: center;
            padding: var(--espaco-sm);
            position: relative;
            z-index: 2; /* Acima da imagem */
        }

        .container {
            display: flex;
            flex-wrap: nowrap;
            min-height: var(--altura-total);
            width: 100%; 
            margin: 0;
        }

        main {
            flex: 0 1 55%; /* 55% para o main */
            padding: var(--espaco-sm);
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: var(--borda-radius);
            box-shadow: var(--sombra);
            z-index: 1; /* Acima da imagem */
        }

        aside.imagem-lateral {
            position: fixed;
            top: 0;
            right: 0;
            width: 45%; /* 45% para a imagem */
            height: var(--altura-total);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 0; /* Abaixo de header, main e footer */
        }

        aside.imagem-lateral img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        section {
            margin-bottom: var(--espaco-md);
        }

        .form-container {
            display: flex;
            gap: var(--espaco-sm);
        }

        .inputs {
            flex: 1; /* Inputs ocupam espaço disponível */
            display: flex;
            flex-direction: column;
            gap: var(--espaco-sm);
        }

        .botoes {
            flex: 0 0 auto; /* Botões com largura fixa */
            display: flex;
            flex-direction: column;
            gap: var(--espaco-sm);
            width: 250px; /* Ajustável */
        }

        button {
            padding: var(--espaco-xs) var(--espaco-sm);
            border: none;
            border-radius: var(--borda-radius);
            background-color: var(--cor-primaria);
            color: var(--cor-branco);
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s ease;
            width: 100%;
        }

        button:hover {
            background-color: var(--cor-secundaria);
        }

        button:focus {
            outline: 3px solid var(--cor-primaria);
        }

        input {
            padding: var(--espaco-xs);
            border: 1px solid var(--cor-primaria);
            border-radius: var(--borda-radius);
            font-size: 1rem;
            max-width: 350px;
            width: 100%; /* Garante que não ultrapasse o contêiner pai */
        }

        input:invalid {
            border-color: var(--cor-erro);
        }

        input::placeholder {
            color: #666;
            font-style: italic;
        }

        #notaFiscal {
            white-space: pre-wrap;
            background: var(--cor-branco);
            padding: var(--espaco-sm);
            border-radius: var(--borda-radius);
            box-shadow: var(--sombra);
            transition: background-color 0.3s ease;
        }

        #notaFiscal.mostrar {
            background-color: var(--cor-sucesso);
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                width: 100%;
            }

            main {
                flex: 1 1 100%;
                margin: var(--espaco-sm);
            }

            aside.imagem-lateral {
                position: relative;
                width: 100%;
                height: 300px;
                z-index: 0;
            }

            aside.imagem-lateral img {
                height: 100%;
                max-height: 300px;
            }

            .form-container {
                flex-direction: column;
            }

            .botoes {
                width: 100%;
            }

            .inputs {
                width: 100%;
            }

            input {
                max-width: 100%;
            }
        }

        @media (max-width: 600px) {
            body {
                font-size: 0.9rem;
            }

            input {
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <header>
        <h1>Mercadinho da Esquina</h1>
        <p aria-label="Slogan do mercadinho">Sempre com os melhores preços!</p>
    </header>

    <div class="container">
        <main>
            <section>
                <h2>Cadastro de Produtos</h2>
                <form id="produtoForm">
                    <div class="form-container">
                        <div class="inputs">
                            <input type="text" id="nome" placeholder="Nome do Produto" required
                                aria-label="Nome do Produto" aria-required="true">
                            <input type="number" id="valor" placeholder="Valor Unitário (R$)" step="0.01" min="0"
                                required aria-label="Valor Unitário em Reais" aria-required="true">
                            <input type="number" id="quantidade" placeholder="Quantidade" min="1" required
                                aria-label="Quantidade de Produtos" aria-required="true">
                        </div>
                        <div class="botoes">
                            <button type="button" id="limpar" aria-label="Limpar nota fiscal">Limpar Nota</button>
                            <button type="button" id="finalizar"
                                aria-label="Finalizar compra e gerar nota fiscal">Finalizar Compra</button>
                            <button type="submit" aria-label="Adicionar produto à lista">Adicionar Produto</button>
                        </div>
                    </div>
                </form>
            </section>

            <section>
                <h2>Nota Fiscal</h2>
                <article id="notaFiscal" role="region" aria-label="Nota Fiscal do Cliente" aria-live="polite">
                    Nenhuma compra registrada ainda.
                </article>
            </section>

            <aside>
                <h3>Dica:</h3>
                <p>Utilize valores decimais com ponto (ex: 2.50) ou vírgula (ex: 2,50) — o sistema entende ambos!</p>
            </aside>
        </main>

        <aside class="imagem-lateral" aria-hidden="true">
            <img src="./mercado.avif" alt="Foto ilustrativa do mercado"
                onerror="this.src='https://via.placeholder.com/600x800'" loading="lazy" />
        </aside>
    </div>

    <footer>
        <p>© 2025 Mercadinho da Esquina</p>
    </footer>

    <script>
        const produtos = carregarProdutos();
        const notaFiscal = document.getElementById("notaFiscal");
        const form = document.getElementById("produtoForm");
        const finalizarBtn = document.getElementById("finalizar");
        const limparBtn = document.getElementById("limpar");

        form.addEventListener("submit", (e) => {
            e.preventDefault();
            const nome = document.getElementById("nome").value.trim();
            const valorUnitario = parseFloat(document.getElementById("valor").value.replace(",", "."));
            const quantidade = parseInt(document.getElementById("quantidade").value);

            if (!nome || isNaN(valorUnitario) || valorUnitario <= 0 || isNaN(quantidade) || quantidade <= 0) {
                alert("Por favor, preencha todos os campos corretamente. O valor e a quantidade devem ser positivos.");
                return;
            }

            const valorTotal = valorUnitario * quantidade;
            produtos.push({ nome, quantidade, valorUnitario, valorTotal });
            salvarProdutos(produtos);
            form.reset();
            alert("Produto adicionado com sucesso!");
        });

        finalizarBtn.addEventListener("click", () => {
            if (produtos.length === 0) {
                notaFiscal.textContent = "Nenhuma compra registrada ainda.";
                return;
            }

            let nota = "Nota Fiscal:\n\n";
            let totalFinal = 0;

            produtos.forEach((p, i) => {
                nota += `${i + 1}. ${p.nome} - ${p.quantidade} un. x ${p.valorUnitario.toLocaleString('pt-BR', {
                    style: 'currency',
                    currency: 'BRL'
                })} = ${p.valorTotal.toLocaleString('pt-BR', {
                    style: 'currency',
                    currency: 'BRL'
                })}\n`;
                totalFinal += p.valorTotal;
            });

            nota += `\nTotal da compra: ${totalFinal.toLocaleString('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            })}`;

            notaFiscal.textContent = nota;
            notaFiscal.classList.add("mostrar");
            setTimeout(() => notaFiscal.classList.remove("mostrar"), 2500);
        });

        limparBtn.addEventListener("click", () => {
            produtos.length = 0;
            salvarProdutos(produtos);
            notaFiscal.textContent = "Nenhuma compra registrada ainda.";
            notaFiscal.classList.remove("mostrar");
        });

        function salvarProdutos(produtos) {
            localStorage.setItem("produtos", JSON.stringify(produtos));
        }

        function carregarProdutos() {
            return JSON.parse(localStorage.getItem("produtos")) || [];
        }

        if (produtos.length > 0) {
            finalizarBtn.click();
        }
    </script>
</body>

</html>
-->

<!--
<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mercadinho da Esquina</title>
    link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet"
    <link rel="stylesheet" href="./fonts.css">
    <style>
        :root {
            /* Cores */
            --cor-primaria: #339e67;
            --cor-secundaria: #de9c31;
            --cor-texto: #161f1a;
            --cor-sucesso: #e9f5ff;
            --cor-branco: #ffffff;
            --cor-erro: #ffcccc;

            /* Espaçamentos */
            --espaco-xs: 0.5rem;
            --espaco-sm: 1rem;
            --espaco-md: 2rem;

            /* Bordas e sombras */
            --borda-radius: 8px;
            --sombra: 0 2px 10px rgba(22, 31, 26, 0.1);

            /* Fontes */
            --fonte-base: 16px;
            --fonte-titulo: 1.5rem;
            --fonte-family-principal: 'Poppins', sans-serif;

            /* Layout */
            --altura-total: 100dvh;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--fonte-family-principal), sans-serif;
            background-color: var(--cor-secundaria);
            color: var(--cor-texto);
            line-height: 1.6;
            font-size: var(--fonte-base);
            margin: 0;
            padding: 0;
        }

        h1 {
            font-size: 3rem;
        }

        header p {
            font-size: 1.5rem;
        }

        header,
        footer {
            background-color: rgba(51, 158, 103, 0.9);
            color: var(--cor-branco);
            text-align: center;
            padding: var(--espaco-sm);
            position: relative;
            z-index: 2;
        }

        .container {
            display: flex;
            flex-wrap: nowrap;
            min-height: var(--altura-total);
            width: 100%;
            margin: 0;
        }

        main {
            flex: 0 1 55%;
            padding: var(--espaco-sm);
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: var(--borda-radius);
            box-shadow: var(--sombra);
            z-index: 1;
        }

        aside.imagem-lateral {
            position: fixed;
            top: 0;
            right: 0;
            width: 45%;
            height: var(--altura-total);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 0;
        }

        aside.imagem-lateral img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        section {
            margin-bottom: var(--espaco-md);
        }

        .form-container {
            display: flex;
            gap: var(--espaco-sm);
        }

        .inputs {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: var(--espaco-sm);
        }

        .botoes {
            flex: 0 0 auto;
            display: flex;
            flex-direction: column;
            gap: var(--espaco-sm);
            width: 150px;
        }

        button {
            padding: var(--espaco-xs) var(--espaco-sm);
            border: none;
            border-radius: var(--borda-radius);
            background-color: var(--cor-primaria);
            color: var(--cor-branco);
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s ease;
            width: 100%;
        }

        button:hover {
            background-color: #2a8c58;
        }

        button:focus {
            outline: 3px solid var(--cor-secundaria);
        }

        input {
            padding: var(--espaco-xs);
            border: 1px solid var(--cor-primaria);
            border-radius: var(--borda-radius);
            font-size: 1rem;
            max-width: 350px;
            width: 100%;
        }

        input:invalid {
            border-color: var(--cor-erro);
        }

        input::placeholder {
            color: #666;
            font-style: italic;
        }

        .mensagem {
            padding: var(--espaco-sm);
            border-radius: var(--borda-radius);
            margin-bottom: var(--espaco-sm);
            text-align: center;
            font-size: 1rem;
            transition: opacity 0.3s ease;
        }

        .mensagem.sucesso {
            background-color: var(--cor-sucesso);
            color: var(--cor-texto);
        }

        .mensagem.erro {
            background-color: var(--cor-erro);
            color: var(--cor-texto);
        }

        #notaFiscal {
            background: var(--cor-branco);
            padding: var(--espaco-sm);
            border-radius: var(--borda-radius);
            box-shadow: var(--sombra);
            transition: background-color 0.3s ease;
        }

        #notaFiscal.mostrar {
            background-color: var(--cor-sucesso);
        }

        #notaFiscal table {
            width: 100%;
            border-collapse: collapse;
            margin-top: var(--espaco-sm);
        }

        #notaFiscal th,
        #notaFiscal td {
            padding: var(--espaco-xs);
            border: 1px solid var(--cor-primaria);
            text-align: left;
        }

        #notaFiscal th {
            background-color: var(--cor-primaria);
            color: var(--cor-branco);
        }

        #notaFiscal .total {
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                width: 100%;
            }

            main {
                flex: 1 1 100%;
                margin: var(--espaco-sm);
            }

            aside.imagem-lateral {
                position: relative;
                width: 100%;
                height: 300px;
                z-index: 0;
            }

            aside.imagem-lateral img {
                height: 100%;
                max-height: 300px;
            }

            .form-container {
                flex-direction: column;
            }

            .botoes {
                width: 100%;
            }

            .inputs {
                width: 100%;
            }

            input {
                max-width: 100%;
            }
        }

        @media (max-width: 600px) {
            body {
                font-size: 0.9rem;
            }

            input {
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <header>
        <h1>Mercadinho da Esquina</h1>
        <p aria-label="Slogan do mercadinho">Sempre com os melhores preços!</p>
    </header>

    <div class="container">
        <main>
            <section>
                <h2>Cadastro de Produtos</h2>
                <form id="produtoForm">
                    <div class="mensagem" aria-live="polite"></div>
                    <div class="form-container">
                        <div class="inputs">
                            <input type="text" id="nome" placeholder="Nome do Produto" required
                                aria-label="Nome do Produto" aria-required="true">
                            <input type="number" id="valor" placeholder="Valor Unitário (R$)" step="0.01" min="0"
                                required aria-label="Valor Unitário em Reais" aria-required="true">
                            <input type="number" id="quantidade" placeholder="Quantidade" min="1" required
                                aria-label="Quantidade de Produtos" aria-required="true">
                        </div>
                        <div class="botoes">
                            <button type="button" id="limpar" aria-label="Limpar nota fiscal">Limpar Nota</button>
                            <button type="button" id="finalizar"
                                aria-label="Finalizar compra e gerar nota fiscal">Finalizar Compra</button>
                            <button type="submit" aria-label="Adicionar produto à lista">Adicionar Produto</button>
                        </div>
                    </div>
                </form>
            </section>

            <section>
                <h2>Nota Fiscal</h2>
                <article id="notaFiscal" role="region" aria-label="Nota Fiscal do Cliente" aria-live="polite">
                    Nenhuma compra registrada ainda.
                </article>
            </section>

            <aside>
                <h3>Dica:</h3>
                <p>Utilize valores decimais com ponto (ex: 2.50) ou vírgula (ex: 2,50) — o sistema entende ambos!</p>
            </aside>
        </main>

        <aside class="imagem-lateral" aria-hidden="true">
            <img src="./mercado.avif" alt="Foto ilustrativa do mercado"
                onerror="this.src='https://placehold.co/600x800?bg=339e67&color=ffffff&text=Placeholder'"
                loading="lazy" />
        </aside>
    </div>

    <footer>
        <p>© 2025 Mercadinho da Esquina</p>
    </footer>

    <script>
        const produtos = carregarProdutos();
        const notaFiscal = document.getElementById("notaFiscal");
        const form = document.getElementById("produtoForm");
        const finalizarBtn = document.getElementById("finalizar");
        const limparBtn = document.getElementById("limpar");
        const mensagemDiv = document.querySelector(".mensagem");

        function mostrarMensagem(mensagem, tipo = "sucesso") {
            mensagemDiv.textContent = mensagem;
            mensagemDiv.className = `mensagem ${tipo}`;
            mensagemDiv.style.opacity = "1";
            setTimeout(() => {
                mensagemDiv.style.opacity = "0";
                setTimeout(() => {
                    mensagemDiv.textContent = "";
                    mensagemDiv.className = "mensagem";
                }, 300);
            }, 3000);
        }

        form.addEventListener("submit", (e) => {
            e.preventDefault();
            const nome = document.getElementById("nome").value.trim();
            const valorInput = document.getElementById("valor").value.replace(",", ".");
            const valorUnitario = parseFloat(valorInput);
            const quantidade = parseInt(document.getElementById("quantidade").value);

            // Validações
            if (!nome) {
                mostrarMensagem("O nome do produto é obrigatório.", "erro");
                return;
            }
            if (nome.length > 50) {
                mostrarMensagem("O nome do produto deve ter no máximo 50 caracteres.", "erro");
                return;
            }
            if (isNaN(valorUnitario) || valorUnitario <= 0) {
                mostrarMensagem("O valor unitário deve ser um número positivo.", "erro");
                return;
            }
            if (!/^\d+(\.\d{1,2})?$/.test(valorInput)) {
                mostrarMensagem("O valor unitário deve ter até 2 casas decimais.", "erro");
                return;
            }
            if (isNaN(quantidade) || quantidade <= 0) {
                mostrarMensagem("A quantidade deve ser um número inteiro positivo.", "erro");
                return;
            }

            const valorTotal = valorUnitario * quantidade;
            produtos.push({ nome, quantidade, valorUnitario, valorTotal });
            salvarProdutos(produtos);
            form.reset();
            mostrarMensagem("Produto adicionado com sucesso!", "sucesso");
        });

        finalizarBtn.addEventListener("click", () => {
            if (produtos.length === 0) {
                notaFiscal.innerHTML = "Nenhuma compra registrada ainda.";
                mostrarMensagem("Nenhuma compra registrada para gerar a nota fiscal.", "erro");
                return;
            }

            let totalFinal = 0;
            let tabela = `
                <table>
                    <thead>
                        <tr>
                            <th>Item</th>
                            <th>Produto</th>
                            <th>Quantidade</th>
                            <th>Valor Unitário</th>
                            <th>Valor Total</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            produtos.forEach((p, i) => {
                tabela += `
                    <tr>
                        <td>${i + 1}</td>
                        <td>${p.nome}</td>
                        <td>${p.quantidade} un.</td>
                        <td>${p.valorUnitario.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</td>
                        <td>${p.valorTotal.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</td>
                    </tr>
                `;
                totalFinal += p.valorTotal;
            });

            tabela += `
                    <tr class="total">
                        <td colspan="4">Total da compra:</td>
                        <td>${totalFinal.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</td>
                    </tr>
                </tbody>
                </table>
            `;

            notaFiscal.innerHTML = `<h3>Nota Fiscal</h3>${tabela}`;
            notaFiscal.classList.add("mostrar");
            setTimeout(() => notaFiscal.classList.remove("mostrar"), 2500);
            mostrarMensagem("Nota fiscal gerada com sucesso!", "sucesso");
        });

        limparBtn.addEventListener("click", () => {
            produtos.length = 0;
            salvarProdutos(produtos);
            notaFiscal.innerHTML = "Nenhuma compra registrada ainda.";
            notaFiscal.classList.remove("mostrar");
            mostrarMensagem("Nota fiscal limpa com sucesso!", "sucesso");
        });

        function salvarProdutos(produtos) {
            localStorage.setItem("produtos", JSON.stringify(produtos));
        }

        function carregarProdutos() {
            return JSON.parse(localStorage.getItem("produtos")) || [];
        }

        if (produtos.length > 0) {
            finalizarBtn.click();
        }
    </script>
</body>

</html>
-->

<!--
<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mercadinho da Esquina</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Cores */
            --cor-primaria: #339e67;
            --cor-secundaria: #de9c31;
            --cor-texto: #161f1a;
            --cor-sucesso: #e9f5ff;
            --cor-branco: #ffffff;
            --cor-erro: #ffcccc;

            /* Espaçamentos */
            --espaco-xs: 0.5rem;
            --espaco-sm: 1rem;
            --espaco-md: 2rem;

            /* Bordas e sombras */
            --borda-radius: 8px;
            --sombra: 0 4px 12px rgba(22, 31, 26, 0.1);

            /* Fontes */
            --fonte-base: 16px;
            --fonte-titulo: 1.5rem;
            --fonte-family-principal: 'Poppins', sans-serif;

            /* Layout */
            --altura-total: 100dvh;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--fonte-family-principal), sans-serif;
            background-color: var(--cor-secundaria);
            color: var(--cor-texto);
            line-height: 1.6;
            font-size: var(--fonte-base);
            margin: 0;
            padding: 0;
        }

        h1 {
            font-size: 3rem;
        }

        header p {
            font-size: 1.5rem;
        }

        header,
        footer {
            background-color: rgba(51, 158, 103, 0.9);
            color: var(--cor-branco);
            text-align: center;
            padding: var(--espaco-sm);
            position: relative;
            z-index: 2;
        }

        .container {
            display: flex;
            flex-wrap: nowrap;
            min-height: var(--altura-total);
            width: 100%;
            margin: 0;
        }

        main {
            flex: 0 1 55%;
            padding: var(--espaco-sm);
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: var(--borda-radius);
            box-shadow: var(--sombra);
            z-index: 1;
        }

        aside.imagem-lateral {
            position: fixed;
            top: 0;
            right: 0;
            width: 45%;
            height: var(--altura-total);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 0;
        }

        aside.imagem-lateral img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        section {
            margin-bottom: var(--espaco-md);
        }

        .form-container {
            display: flex;
            gap: var(--espaco-sm);
        }

        .inputs {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: var(--espaco-sm);
        }

        .botoes {
            flex: 0 0 auto;
            display: flex;
            flex-direction: column;
            gap: var(--espaco-sm);
            width: 150px;
        }

        button {
            padding: var(--espaco-xs) var(--espaco-sm);
            border: none;
            border-radius: var(--borda-radius);
            background-color: var(--cor-primaria);
            color: var(--cor-branco);
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s ease;
            width: 100%;
        }

        button:hover {
            background-color: #2a8c58;
        }

        button:focus {
            outline: 3px solid var(--cor-secundaria);
        }

        input {
            padding: var(--espaco-xs);
            border: 1px solid var(--cor-primaria);
            border-radius: var(--borda-radius);
            font-size: 1rem;
            max-width: 350px;
            width: 100%;
        }

        input:invalid {
            border-color: var(--cor-erro);
        }

        input::placeholder {
            color: #666;
            font-style: italic;
        }

        .mensagem {
            padding: var(--espaco-sm);
            border-radius: var(--borda-radius);
            margin-bottom: var(--espaco-sm);
            text-align: center;
            font-size: 1rem;
            transition: opacity 0.3s ease;
            max-width: 350px;
        }

        .mensagem.sucesso {
            background-color: var(--cor-sucesso);
            color: var(--cor-texto);
        }

        .mensagem.erro {
            background-color: var(--cor-erro);
            color: var(--cor-texto);
        }

        #notaFiscal {
            background: var(--cor-branco);
            padding: var(--espaco-sm);
            border-radius: var(--borda-radius);
            box-shadow: var(--sombra);
            transition: background-color 0.3s ease;
        }

        #notaFiscal.mostrar {
            background-color: var(--cor-sucesso);
        }

        #notaFiscal table {
            width: 100%;
            border-collapse: collapse;
            margin-top: var(--espaco-sm);
        }

        #notaFiscal th,
        #notaFiscal td {
            padding: var(--espaco-xs);
            border: 1px solid var(--cor-primaria);
            text-align: left;
        }

        #notaFiscal th {
            background-color: var(--cor-primaria);
            color: var(--cor-branco);
        }

        #notaFiscal .total {
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                width: 100%;
            }

            main {
                flex: 1 1 100%;
                margin: var(--espaco-sm);
            }

            aside.imagem-lateral {
                position: relative;
                width: 100%;
                height: 300px;
                z-index: 0;
            }

            aside.imagem-lateral img {
                height: 100%;
                max-height: 300px;
            }

            .form-container {
                flex-direction: column;
            }

            .botoes {
                width: 100%;
            }

            .inputs {
                width: 100%;
            }

            input {
                max-width: 100%;
            }
        }

        @media (max-width: 600px) {
            body {
                font-size: 0.9rem;
            }

            input {
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <header>
        <h1>Mercadinho da Esquina</h1>
        <p aria-label="Slogan do mercadinho">Sempre com os melhores preços!</p>
    </header>

    <div class="container">
        <main>
            <section>
                <h2>Cadastro de Produtos</h2>
                <form id="produtoForm">
                    <div class="mensagem" id="mensagem" aria-live="polite"></div>
                    <div class="form-container">
                        <div class="inputs">
                            <input type="text" id="nome" placeholder="Nome do Produto" required
                                aria-label="Nome do Produto" aria-required="true" aria-describedby="mensagem">
                            <input type="number" id="valor" placeholder="Valor Unitário (R$)" step="0.01" min="0"
                                required aria-label="Valor Unitário em Reais" aria-required="true" aria-describedby="mensagem">
                            <input type="number" id="quantidade" placeholder="Quantidade" min="1" required
                                aria-label="Quantidade de Produtos" aria-required="true" aria-describedby="mensagem">
                        </div>
                        <div class="botoes">
                            <button type="button" id="limpar" aria-label="Limpar nota fiscal">Limpar Nota</button>
                            <button type="button" id="finalizar"
                                aria-label="Finalizar compra e gerar nota fiscal">Finalizar Compra</button>
                            <button type="submit" aria-label="Adicionar produto à lista">Adicionar Produto</button>
                        </div>
                    </div>
                </form>
            </section>

            <section>
                <h2>Nota Fiscal</h2>
                <article id="notaFiscal" role="region" aria-label="Nota Fiscal do Cliente" aria-live="polite">
                    Nenhuma compra registrada ainda.
                </article>
            </section>

            <aside>
                <h3>Dica:</h3>
                <p>Utilize valores decimais com ponto (ex: 2.50) ou vírgula (ex: 2,50) — o sistema entende ambos!</p>
            </aside>
        </main>

        <aside class="imagem-lateral" aria-hidden="true">
            <img src="./mercado.avif" alt="Foto ilustrativa do mercado"
                onerror="this.src='https://placehold.co/600x800?bg=339e67&color=ffffff&text=Placeholder'" loading="lazy" />
        </aside>
    </div>

    <footer>
        <p>© 2025 Mercadinho da Esquina</p>
    </footer>

    <script>
        const produtos = carregarProdutos();
        const notaFiscal = document.getElementById("notaFiscal");
        const form = document.getElementById("produtoForm");
        const finalizarBtn = document.getElementById("finalizar");
        const limparBtn = document.getElementById("limpar");
        const mensagemDiv = document.getElementById("mensagem");

        function mostrarMensagem(mensagem, tipo = "sucesso") {
            mensagemDiv.textContent = mensagem;
            mensagemDiv.className = `mensagem ${tipo}`;
            mensagemDiv.style.opacity = "1";
            setTimeout(() => {
                mensagemDiv.style.opacity = "0";
                setTimeout(() => {
                    mensagemDiv.textContent = "";
                    mensagemDiv.className = "mensagem";
                }, 300);
            }, 3000);
        }

        form.addEventListener("submit", (e) => {
            e.preventDefault();
            const nomeInput = document.getElementById("nome");
            const valorInput = document.getElementById("valor");
            const quantidadeInput = document.getElementById("quantidade");
            const nome = nomeInput.value.trim();
            const valorStr = valorInput.value.replace(",", ".");
            const valorUnitario = parseFloat(valorStr);
            const quantidade = parseInt(quantidadeInput.value);

            // Validações
            if (!nome) {
                mostrarMensagem("O nome do produto é obrigatório.", "erro");
                nomeInput.focus();
                return;
            }
            if (nome.length > 50) {
                mostrarMensagem("O nome do produto deve ter no máximo 50 caracteres.", "erro");
                nomeInput.focus();
                return;
            }
            if (valorStr === "" || isNaN(valorUnitario)) {
                mostrarMensagem("O valor unitário deve ser um número válido.", "erro");
                valorInput.focus();
                return;
            }
            if (valorUnitario <= 0) {
                mostrarMensagem("O valor unitário deve ser maior que zero.", "erro");
                valorInput.focus();
                return;
            }
            if (!/^\d+(\.\d{1,2})?$/.test(valorStr)) {
                mostrarMensagem("O valor unitário deve ter até 2 casas decimais.", "erro");
                valorInput.focus();
                return;
            }
            if (isNaN(quantidade) || quantidadeInput.value === "") {
                mostrarMensagem("A quantidade deve ser um número inteiro.", "erro");
                quantidadeInput.focus();
                return;
            }
            if (quantidade <= 0) {
                mostrarMensagem("A quantidade deve ser maior que zero.", "erro");
                quantidadeInput.focus();
                return;
            }

            const valorTotal = valorUnitario * quantidade;
            produtos.push({ nome, quantidade, valorUnitario, valorTotal });
            salvarProdutos(produtos);
            form.reset();
            mostrarMensagem("Produto adicionado com sucesso!", "sucesso");
        });

        finalizarBtn.addEventListener("click", () => {
            if (produtos.length === 0) {
                notaFiscal.innerHTML = "Nenhuma compra registrada ainda.";
                mostrarMensagem("Nenhuma compra registrada para gerar a nota fiscal.", "erro");
                return;
            }

            let totalFinal = 0;
            let tabela = `
                <table>
                    <thead>
                        <tr>
                            <th>Item</th>
                            <th>Produto</th>
                            <th>Quantidade</th>
                            <th>Valor Unitário</th>
                            <th>Valor Total</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            produtos.forEach((p, i) => {
                tabela += `
                    <tr>
                        <td>${i + 1}</td>
                        <td>${p.nome}</td>
                        <td>${p.quantidade} un.</td>
                        <td>${p.valorUnitario.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</td>
                        <td>${p.valorTotal.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</td>
                    </tr>
                `;
                totalFinal += p.valorTotal;
            });

            tabela += `
                    <tr class="total">
                        <td colspan="4">Total da compra:</td>
                        <td>${totalFinal.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</td>
                    </tr>
                </tbody>
                </table>
            `;

            const notaAnterior = notaFiscal.innerHTML;
            notaFiscal.innerHTML = `<h3>Nota Fiscal</h3>${tabela}`;
            if (notaAnterior !== notaFiscal.innerHTML) {
                notaFiscal.classList.add("mostrar");
                mostrarMensagem("Nota fiscal gerada com sucesso!", "sucesso");
                setTimeout(() => notaFiscal.classList.remove("mostrar"), 2500);
            }
        });

        limparBtn.addEventListener("click", () => {
            if (produtos.length === 0) {
                mostrarMensagem("A nota fiscal já está vazia.", "erro");
                return;
            }
            produtos.length = 0;
            salvarProdutos(produtos);
            notaFiscal.innerHTML = "Nenhuma compra registrada ainda.";
            notaFiscal.classList.remove("mostrar");
            mostrarMensagem("Nota fiscal limpa com sucesso!", "sucesso");
        });

        function salvarProdutos(produtos) {
            localStorage.setItem("produtos", JSON.stringify(produtos));
        }

        function carregarProdutos() {
            return JSON.parse(localStorage.getItem("produtos")) || [];
        }

        if (produtos.length > 0) {
            finalizarBtn.click();
        }
    </script>
</body>

</html>
-->

<!--
<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mercadinho da Esquina</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        /* === Configurações Globais === */
        :root {
            /* Cores */
            --cor-primaria: #339e67;
            --cor-secundaria: #de9c31;
            --cor-texto: #161f1a;
            --cor-sucesso: #e9f5ff;
            --cor-branco: #ffffff;
            --cor-erro: #ffcccc;

            /* Espaçamentos */
            --espaco-xs: 0.5rem;
            --espaco-sm: 1rem;
            --espaco-md: 2rem;

            /* Bordas e sombras */
            --borda-radius: 8px;
            --sombra: 0 4px 12px rgba(22, 31, 26, 0.1);

            /* Fontes */
            --fonte-base: 16px;
            --fonte-titulo: 1.5rem;
            --fonte-family-principal: 'Poppins', sans-serif;

            /* Layout */
            --altura-total: 100dvh;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--fonte-family-principal), sans-serif;
            background-color: var(--cor-secundaria);
            color: var(--cor-texto);
            line-height: 1.6;
            font-size: var(--fonte-base);
            margin: 0;
            padding: 0;
        }

        /* === Cabeçalho e Rodapé === */
        h1 {
            font-size: 3rem;
        }

        header p {
            font-size: 1.5rem;
        }

        header,
        footer {
            background-color: rgba(51, 158, 103, 0.9);
            color: var(--cor-branco);
            text-align: center;
            padding: var(--espaco-sm);
            position: relative;
            z-index: 2;
        }

        /* === Layout Principal === */
        .container {
            display: flex;
            flex-wrap: nowrap;
            min-height: var(--altura-total);
            width: 100%;
            margin: 0;
        }

        main {
            flex: 0 1 55%;
            padding: var(--espaco-sm);
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: var(--borda-radius);
            box-shadow: var(--sombra);
            z-index: 1;
        }

        aside.imagem-lateral {
            position: fixed;
            top: 0;
            right: 0;
            width: 45%;
            height: var(--altura-total);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 0;
        }

        aside.imagem-lateral img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* === Formulário === */
        section {
            margin-bottom: var(--espaco-md);
        }

        .form-container {
            display: flex;
            gap: var(--espaco-sm);
        }

        .inputs {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: var(--espaco-sm);
        }

        .botoes {
            flex: 0 0 auto;
            display: flex;
            flex-direction: column;
            gap: var(--espaco-sm);
            width: 150px;
        }

        button {
            padding: var(--espaco-xs) var(--espaco-sm);
            border: none;
            border-radius: var(--borda-radius);
            background-color: var(--cor-primaria);
            color: var(--cor-branco);
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s ease;
            width: 100%;
        }

        button:hover {
            background-color: #2a8c58;
        }

        button:focus {
            outline: 3px solid var(--cor-secundaria);
        }

        input {
            padding: var(--espaco-xs);
            border: 1px solid var(--cor-primaria);
            border-radius: var(--borda-radius);
            font-size: 1rem;
            max-width: 350px;
            width: 100%;
        }

        input:invalid {
            border-color: var(--cor-erro);
        }

        input::placeholder {
            color: #666;
            font-style: italic;
        }

        /* === Mensagens === */
        .mensagem {
            padding: var(--espaco-sm);
            border: 1px solid rgba(22, 31, 26, 0.2);
            border-radius: var(--borda-radius);
            margin-bottom: var(--espaco-sm);
            text-align: center;
            font-size: 1rem;
            transition: opacity 0.5s ease;
            max-width: 350px;
        }

        .mensagem.sucesso {
            background-color: var(--cor-sucesso);
            color: var(--cor-texto);
        }

        .mensagem.erro {
            background-color: var(--cor-erro);
            color: var(--cor-texto);
        }

        /* === Nota Fiscal === */
        #notaFiscal {
            background: var(--cor-branco);
            padding: var(--espaco-sm);
            border-radius: var(--borda-radius);
            box-shadow: var(--sombra);
            transition: background-color 0.3s ease;
        }

        #notaFiscal.mostrar {
            background-color: var(--cor-sucesso);
        }

        #notaFiscal table {
            width: 100%;
            border-collapse: collapse;
            margin-top: var(--espaco-sm);
        }

        #notaFiscal th,
        #notaFiscal td {
            padding: var(--espaco-sm);
            border: 1px solid var(--cor-primaria);
            text-align: left;
        }

        #notaFiscal th {
            background-color: var(--cor-primaria);
            color: var(--cor-branco);
        }

        #notaFiscal tbody tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        #notaFiscal .total {
            font-weight: bold;
        }

        /* === Responsividade === */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                width: 100%;
            }

            main {
                flex: 1 1 100%;
                margin: var(--espaco-sm);
            }

            aside.imagem-lateral {
                position: relative;
                width: 100%;
                height: 300px;
                z-index: 0;
            }

            aside.imagem-lateral img {
                height: 100%;
                max-height: 300px;
            }

            .form-container {
                flex-direction: column;
            }

            .botoes {
                width: 100%;
            }

            .inputs {
                width: 100%;
            }

            input {
                max-width: 100%;
            }
        }

        @media (max-width: 600px) {
            body {
                font-size: 0.9rem;
            }

            input {
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <header>
        <h1>Mercadinho da Esquina</h1>
        <p aria-label="Slogan do mercadinho">Sempre com os melhores preços!</p>
    </header>

    <div class="container">
        <main>
            <section>
                <h2>Cadastro de Produtos</h2>
                <form id="produtoForm">
                    <div class="mensagem" id="mensagem" role="alert" aria-live="polite"></div>
                    <div class="form-container">
                        <div class="inputs">
                            <input type="text" id="nome" placeholder="Nome do Produto" required
                                   aria-label="Nome do Produto" aria-required="true" aria-describedby="mensagem">
                            <input type="number" id="valor" placeholder="Valor Unitário (R$)" step="0.01" min="0"
                                   required aria-label="Valor Unitário em Reais" aria-required="true" aria-describedby="mensagem">
                            <input type="number" id="quantidade" placeholder="Quantidade" min="1" required
                                   aria-label="Quantidade de Produtos" aria-required="true" aria-describedby="mensagem">
                        </div>
                        <div class="botoes">
                            <button type="button" id="limpar" aria-label="Limpar nota fiscal">Limpar Nota</button>
                            <button type="button" id="finalizar" aria-label="Finalizar compra e gerar nota fiscal">Finalizar Compra</button>
                            <button type="submit" aria-label="Adicionar produto à lista">Adicionar Produto</button>
                        </div>
                    </div>
                </form>
            </section>

            <section>
                <h2>Nota Fiscal</h2>
                <article id="notaFiscal" role="region" aria-label="Nota Fiscal do Cliente" aria-live="polite">
                    Nenhuma compra registrada ainda.
                </article>
            </section>

            <aside>
                <h3>Dica:</h3>
                <p>Utilize valores decimais com ponto (ex: 2.50) ou vírgula (ex: 2,50) — o sistema entende ambos!</p>
            </aside>
        </main>

        <aside class="imagem-lateral" aria-hidden="true">
            <img src="./mercado.avif" alt="Foto ilustrativa do mercado"
                 onerror="this.src='https://placehold.co/600x800?bg=339e67&color=ffffff&text=Placeholder'" loading="lazy">
        </aside>
    </div>

    <footer>
        <p>© 2025 Mercadinho da Esquina</p>
    </footer>

    <script defer>
        // Inicialização
        const produtos = carregarProdutos();
        const notaFiscal = document.getElementById("notaFiscal");
        const form = document.getElementById("produtoForm");
        const finalizarBtn = document.getElementById("finalizar");
        const limparBtn = document.getElementById("limpar");
        const mensagemDiv = document.getElementById("mensagem");

        // Exibe mensagens de sucesso ou erro
        function mostrarMensagem(mensagem, tipo = "sucesso") {
            mensagemDiv.textContent = mensagem;
            mensagemDiv.className = `mensagem ${tipo}`;
            mensagemDiv.style.opacity = "1";
            setTimeout(() => {
                mensagemDiv.style.opacity = "0";
                setTimeout(() => {
                    mensagemDiv.textContent = "";
                    mensagemDiv.className = "mensagem";
                }, 500);
            }, 3000);
        }

        // Manipula envio do formulário
        form.addEventListener("submit", (e) => {
            e.preventDefault();
            const nomeInput = document.getElementById("nome");
            const valorInput = document.getElementById("valor");
            const quantidadeInput = document.getElementById("quantidade");
            const nome = nomeInput.value.trim();
            const valorStr = valorInput.value.replace(",", ".");
            const valorUnitario = parseFloat(valorStr);
            const quantidade = parseInt(quantidadeInput.value);

            // Validações
            if (!nome) {
                mostrarMensagem("O nome do produto é obrigatório.", "erro");
                nomeInput.focus();
                return;
            }
            if (nome.length > 50) {
                mostrarMensagem("O nome do produto deve ter no máximo 50 caracteres.", "erro");
                nomeInput.focus();
                return;
            }
            if (produtos.some(p => p.nome.toLowerCase() === nome.toLowerCase())) {
                mostrarMensagem("Este produto já foi adicionado.", "erro");
                nomeInput.focus();
                return;
            }
            if (valorStr === "" || isNaN(valorUnitario)) {
                mostrarMensagem("O valor unitário deve ser um número válido.", "erro");
                valorInput.focus();
                return;
            }
            if (valorUnitario <= 0) {
                mostrarMensagem("O valor unitário deve ser maior que zero.", "erro");
                valorInput.focus();
                return;
            }
            if (valorUnitario > 10000) {
                mostrarMensagem("O valor unitário não pode exceder R$10.000.", "erro");
                valorInput.focus();
                return;
            }
            if (!/^\d+(\.\d{1,2})?$/.test(valorStr)) {
                mostrarMensagem("O valor unitário deve ter até 2 casas decimais.", "erro");
                valorInput.focus();
                return;
            }
            if (isNaN(quantidade) || quantidadeInput.value === "") {
                mostrarMensagem("A quantidade deve ser um número inteiro.", "erro");
                quantidadeInput.focus();
                return;
            }
            if (quantidade <= 0) {
                mostrarMensagem("A quantidade deve ser maior que zero.", "erro");
                quantidadeInput.focus();
                return;
            }

            // Sanitiza o nome contra XSS
            const nomeSanitizado = nome.replace(/</g, "&lt;").replace(/>/g, "&gt;");

            const valorTotal = valorUnitario * quantidade;
            produtos.push({ nome: nomeSanitizado, quantidade, valorUnitario, valorTotal });
            salvarProdutos(produtos);
            form.reset();
            mostrarMensagem("Produto adicionado com sucesso!", "sucesso");
        });

        // Gera a nota fiscal
        finalizarBtn.addEventListener("click", () => {
            if (produtos.length === 0) {
                notaFiscal.innerHTML = "Nenhuma compra registrada ainda.";
                mostrarMensagem("Nenhuma compra registrada para gerar a nota fiscal.", "erro");
                return;
            }

            let totalFinal = 0;
            let tabela = `
                <table>
                    <thead>
                        <tr>
                            <th scope="col">Item</th>
                            <th scope="col">Produto</th>
                            <th scope="col">Quantidade</th>
                            <th scope="col">Valor Unitário</th>
                            <th scope="col">Valor Total</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            produtos.forEach((p, i) => {
                tabela += `
                    <tr>
                        <td>${i + 1}</td>
                        <td>${p.nome}</td>
                        <td>${p.quantidade} un.</td>
                        <td>${p.valorUnitario.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</td>
                        <td>${p.valorTotal.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</td>
                    </tr>
                `;
                totalFinal += p.valorTotal;
            });

            tabela += `
                    <tr class="total">
                        <td colspan="4">Total da compra:</td>
                        <td>${totalFinal.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</td>
                    </tr>
                </tbody>
                </table>
            `;

            const notaAnterior = notaFiscal.innerHTML;
            notaFiscal.innerHTML = `<h3>Nota Fiscal</h3>${tabela}`;
            if (notaAnterior !== notaFiscal.innerHTML) {
                notaFiscal.classList.add("mostrar");
                mostrarMensagem("Nota fiscal gerada com sucesso!", "sucesso");
                setTimeout(() => notaFiscal.classList.remove("mostrar"), 2500);
            }
        });

        // Limpa a nota fiscal
        limparBtn.addEventListener("click", () => {
            if (produtos.length === 0) {
                mostrarMensagem("A nota fiscal já está vazia.", "erro");
                return;
            }
            produtos.length = 0;
            salvarProdutos(produtos);
            notaFiscal.innerHTML = "Nenhuma compra registrada ainda.";
            notaFiscal.classList.remove("mostrar");
            mostrarMensagem("Nota fiscal limpa com sucesso!", "sucesso");
        });

        // Salva produtos no localStorage
        function salvarProdutos(produtos) {
            localStorage.setItem("produtos", JSON.stringify(produtos));
        }

        // Carrega produtos do localStorage
        function carregarProdutos() {
            return JSON.parse(localStorage.getItem("produtos")) || [];
        }

        // Gera nota fiscal automaticamente se houver produtos salvos
        if (produtos.length > 0) {
            finalizarBtn.click();
        }
    </script>
</body>

</html>
-->

<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mercadinho da Esquina</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        /* === Configurações Globais === */
        :root {
            /* Cores */
            --cor-primaria: #339e67;
            --cor-secundaria: #de9c31;
            --cor-texto: #161f1a;
            --cor-sucesso: #e9f5ff;
            --cor-branco: #ffffff;
            --cor-erro: #ffcccc;

            /* Espaçamentos */
            --espaco-xs: 0.5rem;
            --espaco-sm: 1rem;
            --espaco-md: 2rem;

            /* Bordas e sombras */
            --borda-radius: 8px;
            --sombra: 0 4px 12px rgba(22, 31, 26, 0.1);

            /* Fontes */
            --fonte-base: 16px;
            --fonte-titulo: 1.5rem;
            --fonte-family-principal: 'Poppins', sans-serif;

            /* Layout */
            --altura-total: 100dvh;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--fonte-family-principal), sans-serif;
            background-color: var(--cor-secundaria);
            color: var(--cor-texto);
            line-height: 1.6;
            font-size: var(--fonte-base);
            margin: 0;
            padding: 0;
        }

        /* === Cabeçalho e Rodapé === */
        h1 {
            font-size: 3rem;
        }

        header p {
            font-size: 1.5rem;
        }

        header,
        footer {
            background-color: rgba(51, 158, 103, 0.9);
            color: var(--cor-branco);
            text-align: center;
            padding: var(--espaco-sm);
            position: relative;
            z-index: 2;
        }

        /* === Layout Principal === */
        .container {
            display: flex;
            flex-wrap: nowrap;
            min-height: var(--altura-total);
            width: 100%;
            margin: 0;
        }

        main {
            flex: 0 1 55%;
            padding: var(--espaco-sm);
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: var(--borda-radius);
            box-shadow: var(--sombra);
            z-index: 1;
        }

        aside.imagem-lateral {
            position: fixed;
            top: 0;
            right: 0;
            width: 45%;
            height: var(--altura-total);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 0;
        }

        aside.imagem-lateral img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* === Formulário === */
        section {
            margin-bottom: var(--espaco-md);
        }

        .form-container {
            display: flex;
            gap: var(--espaco-sm);
        }

        .inputs {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: var(--espaco-sm);
        }

        .botoes {
            flex: 0 0 auto;
            display: flex;
            flex-direction: column;
            gap: var(--espaco-sm);
            width: 150px;
        }

        button {
            padding: var(--espaco-xs) var(--espaco-sm);
            border: none;
            border-radius: var(--borda-radius);
            background-color: var(--cor-primaria);
            color: var(--cor-branco);
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s ease;
            width: 100%;
        }

        button:hover {
            background-color: #2a8c58;
        }

        button:focus {
            outline: 3px solid var(--cor-secundaria);
        }

        input {
            padding: var(--espaco-xs);
            border: 1px solid var(--cor-primaria);
            border-radius: var(--borda-radius);
            font-size: 1rem;
            max-width: 350px;
            width: 100%;
        }

        input:invalid {
            border-color: var(--cor-erro);
        }

        input::placeholder {
            color: #666;
            font-style: italic;
        }

        /* === Mensagens === */
        .mensagem {
            padding: var(--espaco-sm);
            border: 1px solid rgba(22, 31, 26, 0.2);
            border-radius: var(--borda-radius);
            margin-bottom: var(--espaco-sm);
            text-align: center;
            font-size: 1rem;
            transition: opacity 0.5s ease;
            max-width: 350px;
        }

        .mensagem.sucesso {
            background-color: var(--cor-sucesso);
            color: var(--cor-texto);
        }

        .mensagem.erro {
            background-color: var(--cor-erro);
            color: var(--cor-texto);
        }

        /* === Nota Fiscal === */
        #notaFiscal {
            background: var(--cor-branco);
            padding: var(--espaco-sm);
            border-radius: var(--borda-radius);
            box-shadow: var(--sombra);
            transition: background-color 0.3s ease;
        }

        #notaFiscal.mostrar {
            background-color: var(--cor-sucesso);
        }

        #notaFiscal table {
            width: 100%;
            border-collapse: collapse;
            margin-top: var(--espaco-sm);
        }

        #notaFiscal th,
        #notaFiscal td {
            padding: var(--espaco-sm);
            border: 1px solid var(--cor-primaria);
            text-align: left;
        }

        #notaFiscal th {
            background-color: var(--cor-primaria);
            color: var(--cor-branco);
        }

        #notaFiscal tbody tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        #notaFiscal .total {
            font-weight: bold;
        }

        /* === Responsividade === */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                width: 100%;
            }

            main {
                flex: 1 1 100%;
                margin: var(--espaco-sm);
            }

            aside.imagem-lateral {
                position: relative;
                width: 100%;
                height: 300px;
                z-index: 0;
            }

            aside.imagem-lateral img {
                height: 100%;
                max-height: 300px;
            }

            .form-container {
                flex-direction: column;
            }

            .botoes {
                width: 100%;
            }

            .inputs {
                width: 100%;
            }

            input {
                max-width: 100%;
            }
        }

        @media (max-width: 600px) {
            body {
                font-size: 0.9rem;
            }

            input {
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <header>
        <h1>Mercadinho da Esquina</h1>
        <p aria-label="Slogan do mercadinho">Sempre com os melhores preços!</p>
    </header>

    <div class="container">
        <main>
            <section>
                <h2>Cadastro de Produtos</h2>
                <form id="produtoForm">
                    <div class="mensagem" id="mensagem" role="alert" aria-live="polite"></div>
                    <div class="form-container">
                        <div class="inputs">
                            <input type="text" id="nome" placeholder="Nome do Produto" required
                                   aria-label="Nome do Produto" aria-required="true" aria-describedby="mensagem">
                            <input type="number" id="valor" placeholder="Valor Unitário (R$)" step="0.01" min="0"
                                   required aria-label="Valor Unitário em Reais" aria-required="true" aria-describedby="mensagem">
                            <input type="number" id="quantidade" placeholder="Quantidade" min="1" required
                                   aria-label="Quantidade de Produtos" aria-required="true" aria-describedby="mensagem">
                        </div>
                        <div class="botoes">
                            <button type="button" id="limpar" aria-label="Limpar nota fiscal">Limpar Nota</button>
                            <button type="button" id="finalizar" aria-label="Finalizar compra e gerar nota fiscal">Finalizar Compra</button>
                            <button type="submit" aria-label="Adicionar produto à lista">Adicionar Produto</button>
                        </div>
                    </div>
                </form>
            </section>

            <section>
                <h2>Nota Fiscal</h2>
                <article id="notaFiscal" role="region" aria-label="Nota Fiscal do Cliente" aria-live="polite">
                    Nenhuma compra registrada ainda.
                </article>
            </section>

            <aside>
                <h3>Dica:</h3>
                <p>Utilize valores decimais com ponto (ex: 2.50) ou vírgula (ex: 2,50) — o sistema entende ambos!</p>
            </aside>
        </main>

        <aside class="imagem-lateral" aria-hidden="true">
            <img src="./mercado.avif" alt="Foto ilustrativa do mercado"
                 onerror="this.src='https://placehold.co/600x800?bg=339e67&color=ffffff&text=Placeholder'" loading="lazy">
        </aside>
    </div>

    <footer>
        <p>© 2025 Mercadinho da Esquina</p>
    </footer>

    <script defer>
        // Inicialização
        const produtos = carregarProdutos();
        const notaFiscal = document.getElementById("notaFiscal");
        const form = document.getElementById("produtoForm");
        const finalizarBtn = document.getElementById("finalizar");
        const limparBtn = document.getElementById("limpar");
        const mensagemDiv = document.getElementById("mensagem");

        // Exibe mensagens de sucesso ou erro
        function mostrarMensagem(mensagem, tipo = "sucesso") {
            mensagemDiv.textContent = mensagem;
            mensagemDiv.className = `mensagem ${tipo}`;
            mensagemDiv.style.opacity = "1";
            setTimeout(() => {
                mensagemDiv.style.opacity = "0";
                setTimeout(() => {
                    mensagemDiv.textContent = "";
                    mensagemDiv.className = "mensagem";
                }, 500);
            }, 3000);
        }

        // Manipula envio do formulário
        form.addEventListener("submit", (e) => {
            e.preventDefault();
            const nomeInput = document.getElementById("nome");
            const valorInput = document.getElementById("valor");
            const quantidadeInput = document.getElementById("quantidade");
            const nome = nomeInput.value.trim();
            const valorStr = valorInput.value.replace(",", ".");
            const valorUnitario = parseFloat(valorStr);
            const quantidade = parseInt(quantidadeInput.value);

            // Validações do nome
            if (!nome) {
                mostrarMensagem("O nome do produto é obrigatório.", "erro");
                nomeInput.focus();
                return;
            }
            if (nome.length > 50) {
                mostrarMensagem("O nome do produto deve ter no máximo 50 caracteres.", "erro");
                nomeInput.focus();
                return;
            }
            if (!/^[A-Za-zÀ-ÿ0-9\s\-\'\.]+$/.test(nome)) {
                mostrarMensagem("O nome do produto contém caracteres inválidos.", "erro");
                nomeInput.focus();
                return;
            }
            if (/^[\s\-\'\.]+$/.test(nome)) {
                mostrarMensagem("O nome do produto não pode conter apenas espaços ou caracteres especiais.", "erro");
                nomeInput.focus();
                return;
            }
            if (produtos.some(p => p.nome.toLowerCase() === nome.toLowerCase())) {
                mostrarMensagem("Este produto já foi adicionado.", "erro");
                nomeInput.focus();
                return;
            }

            // Validações do valor
            if (valorStr === "" || isNaN(valorUnitario)) {
                mostrarMensagem("O valor unitário deve ser um número válido.", "erro");
                valorInput.focus();
                return;
            }
            if (valorUnitario <= 0) {
                mostrarMensagem("O valor unitário deve ser maior que zero.", "erro");
                valorInput.focus();
                return;
            }
            if (valorUnitario > 10000) {
                mostrarMensagem("O valor unitário não pode exceder R$10.000.", "erro");
                valorInput.focus();
                return;
            }
            if (!/^\d+(\.\d{1,2})?$/.test(valorStr)) {
                mostrarMensagem("O valor unitário deve ter até 2 casas decimais.", "erro");
                valorInput.focus();
                return;
            }

            // Validações da quantidade
            if (isNaN(quantidade) || quantidadeInput.value === "") {
                mostrarMensagem("A quantidade deve ser um número inteiro.", "erro");
                quantidadeInput.focus();
                return;
            }
            if (quantidade <= 0) {
                mostrarMensagem("A quantidade deve ser maior que zero.", "erro");
                quantidadeInput.focus();
                return;
            }

            // Sanitiza o nome contra XSS
            const nomeSanitizado = nome.replace(/</g, "&lt;").replace(/>/g, "&gt;");

            const valorTotal = valorUnitario * quantidade;
            produtos.push({ nome: nomeSanitizado, quantidade, valorUnitario, valorTotal });
            salvarProdutos(produtos);
            form.reset();
            mostrarMensagem("Produto adicionado com sucesso!", "sucesso");
        });

        // Gera a nota fiscal
        finalizarBtn.addEventListener("click", () => {
            if (produtos.length === 0) {
                notaFiscal.innerHTML = "Nenhuma compra registrada ainda.";
                mostrarMensagem("Nenhuma compra registrada para gerar a nota fiscal.", "erro");
                return;
            }

            let totalFinal = 0;
            let tabela = `
                <table>
                    <thead>
                        <tr>
                            <th scope="col">Item</th>
                            <th scope="col">Produto</th>
                            <th scope="col">Quantidade</th>
                            <th scope="col">Valor Unitário</th>
                            <th scope="col">Valor Total</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            produtos.forEach((p, i) => {
                tabela += `
                    <tr>
                        <td>${i + 1}</td>
                        <td>${p.nome}</td>
                        <td>${p.quantidade} un.</td>
                        <td>${p.valorUnitario.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</td>
                        <td>${p.valorTotal.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</td>
                    </tr>
                `;
                totalFinal += p.valorTotal;
            });

            tabela += `
                    <tr class="total">
                        <td colspan="4">Total da compra:</td>
                        <td>${totalFinal.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</td>
                    </tr>
                </tbody>
                </table>
            `;

            const notaAnterior = notaFiscal.innerHTML;
            notaFiscal.innerHTML = `<h3>Nota Fiscal</h3>${tabela}`;
            if (notaAnterior !== notaFiscal.innerHTML) {
                notaFiscal.classList.add("mostrar");
                mostrarMensagem("Nota fiscal gerada com sucesso!", "sucesso");
                setTimeout(() => notaFiscal.classList.remove("mostrar"), 2500);
            }
        });

        // Limpa a nota fiscal
        limparBtn.addEventListener("click", () => {
            if (produtos.length === 0) {
                mostrarMensagem("A nota fiscal já está vazia.", "erro");
                return;
            }
            produtos.length = 0;
            salvarProdutos(produtos);
            notaFiscal.innerHTML = "Nenhuma compra registrada ainda.";
            notaFiscal.classList.remove("mostrar");
            mostrarMensagem("Nota fiscal limpa com sucesso!", "sucesso");
        });

        // Salva produtos no localStorage
        function salvarProdutos(produtos) {
            localStorage.setItem("produtos", JSON.stringify(produtos));
        }

        // Carrega produtos do localStorage
        function carregarProdutos() {
            return JSON.parse(localStorage.getItem("produtos")) || [];
        }

        // Gera nota fiscal automaticamente se houver produtos salvos
        if (produtos.length > 0) {
            finalizarBtn.click();
        }
    </script>
</body>

</html>